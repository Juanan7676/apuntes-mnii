\renewcommand{\tt}{t}
\newcommand{\yy}{y}
\newcommand{\ta}{a}
\newcommand{\tb}{b}
\newcommand{\ycero}{y_a}
\newcommand{\ee}{e\xspace}
\newcommand{\sol}{y}
\newcommand{\lipschitz}{Lipschitz\xspace}
\newcommand{\globLipschitz}{$y$--\lipschitz}
\newcommand{\locLipschitz}{localmente $y$--\lipschitz}

\chapter[Problemas de valor inicial para EDOs de primer orden]
{Problemas de valor inicial para ecuaciones diferenciales de primer
  orden%
  \footnote{\licenseInfo}}

Son muy numerosos los problemas (con orígenes diversos como la física,
química, biología o economía) que se formulan matemáticamente en
términos de ecuaciones diferenciales, es decir, ecuaciones cuya
incógnita, una función $y(x)$, describe un fenómeno dado a través de
una ley que relaciona a esta función con sus derivadas. La formulación
adecuada de esta ley junto a algunos datos adicionales (condiciones
iniciales) garantizarán el buen planteamiento del problema.

Este tema se centra en la resolución numérica de problemas de valor
inicial (o problemas de Cauchy) asociados a ecuaciones diferenciales
ordinarias (EDO). Este tipo de problemas se escriben de la siguiente
forma:
\begin{equation}
  \label{eq:pvi}
  \tag{PVI}
  \left\{
  \begin{aligned}
    &y' = f(\tt,\yy), \quad \tt\in[\ta,\tb],
    \\
    &y(\ta) = \ycero,
  \end{aligned}
  \right.
\end{equation}
donde la función $f:[\ta,\tb]\times\Rset\to\Rset$ y el estado inicial
$\ycero\in\Rset$ son datos conocidos. En el próximo tema se estudia el
caso general, donde $f:[\ta,\tb]\times\Rset^n\to\Rset^n$ \ee
$\ycero\in\Rset^n$, con $n\in\Nset$. En numerosos problemas de la
ciencia y la ingeniería, la variable $\tt$ representa el tiempo aunque
no siempre es necesario que sea así. Con frecuencia
hablaremos de $\tt$ como la <<variable temporal>>).

\begin{definition}
  Llamamos solución de~\eqref{eq:pvi} a toda función $\sol\in
  C^1([\ta,\tb])$ tal que $\sol'(\tt)=f(\tt,\sol(\tt))$ para todo
  $\tt\in[\ta,\tb]$ y además $\sol(\ta)=\ycero$.\label{def:3}
\end{definition}

Obsérvese que, según esta definición, el
concepto de solución tiene un sentido global (en todo el intervalo
$[a,b]$), no local (en un entorno de $\ta$).
Como paso previo a la resolución numérica de~\eqref{eq:pvi}, deberemos
garantizar que el problema~\eqref{eq:pvi} está bien planteado, es
decir asegurar la existencia y unicidad de solución en el sentido
anterior. 

\section{Resultados teóricos preliminares}
\label{sec:tema4:resultados-teoricos}

A continuación recordaremos algunos resultados teóricos relacionados
con la existencia y unicidad de solución del problema de
Cauchy~(\ref{eq:pvi}), que serán dados sin demostración. La clave en
estos resultados será el analizar si la función $f(x,y)$ es verifica
la condición de Lipschitz que se define a continuación:

\begin{definition}
  \label{def:lipschitz}
  Decimos que una función $f(\tt,y)$ verifica la condición de
  \resaltar{Lipschitz uniformemente} (o globalmente) respecto a $y$ en
    $[\ta,\tb]$ (o simplemente que $f$ es \globLipschitz)
    si existe $L>0$ tal que
  \begin{equation*}
    |f(\tt,y) - f(\tt,z)| \le L |y-z|, \quad \forall \tt\in [\ta,\tb],
    \quad  \forall y,z\in \Rset.
  \end{equation*}
  Decimos que una función $f(\tt,y)$ verifica la condición de
  \resaltar{Lipschitz localmente} respecto a $y$ en
  $[\ta,\tb]$ (o que $f$ es \locLipschitz) si para todo compacto
  $K\subset\Rset$ existe $L_K>0$ tal que
  \begin{equation*}
    |f(\tt,y) - f(\tt,z)| \le L_K |y-z|, \quad \forall \tt\in [\ta,\tb],
    \quad  \forall y,z\in K.
  \end{equation*}
\end{definition}

Antes del siguiente comentario, fijaremos la siguiente
\textbf{notación}: $\dy f$ designará a la derivada parcial de $f$
respecto a $y$, es decir $\dy f(\tt,y) = \frac{\partial f}{\partial
  \yy}(\tt,y)$. Para el resto de las variables se usarán notaciones
similares.
\begin{remark}
  En la práctica, para estudiar si una función es (local o
  globalmente) Lipschitz se suelen usar las siguientes condiciones
  suficientes:
  \begin{enumerate}
  \item Si $\dy f$ es continua en $[\ta,\tb]\times\Rset$, entonces $f$
    es \locLipschitz.
  \item Si además $\dy f$ está acotada en
    $[\ta,\tb]\times\Rset$, entonces $f$ es uniformemente
    \globLipschitz.
  \end{enumerate}
  Comprobaremos la segunda de estas afirmaciones (la primera se
  demuestra de forma análoga, usando que $\dy f$ está acotada
  en todo compacto $K\subset\Rset)$.
  Si $\dy f$ es continua en $[\ta,\tb]\times\Rset$, entonces en cada
  <<instante>> $t\in[\ta,\tb]$ la función
  $$\dy f(t,\cdot):\Rset \to \Rset$$
  es continua. Aplicando el teorema del valor medio, se tiene que
  dados $y$, $z\in\Rset$ existe $y^*$ entre $y$ y $z$ tal que
  \begin{equation*}
    |f(\tt,y)-f(\tt,z)| = |\dy f(\tt,y^*) \cdot (y-z)|.
  \end{equation*}
  Como además  $\dy f$ está acotada, existe $L>0$ tal que $|\dy
  f(\tt,y)|\le L$ para todo $(\tt,y)\in [\ta,\tb]\times\Rset$ y
  entonces 
  \begin{equation*}
    |f(\tt,y) - f(\tt,z)| \le L |y-z|.
  \end{equation*}
\end{remark}

\begin{example}
  La función $$f(x,y)=y^2$$ es \locLipschitz en cualquier intervalo
  $[\ta,\tb]$, pues su derivada parcial $\dy f(x,y)=2y$ es continua. Sin
  embargo, esta función no está acotada cuando $y\in\Rset$, por lo que
  no tenemos garantías de que $f(x,y)$ sea uniformemente \globLipschitz.
  
  Veamos que realmente $f(x,y)$ no es a uniformemente \globLipschitz,
  comprobando que para cualquier constate $L>0$, podemos encontrar dos
  valores, $y_L$, $z_L\in\Rset$ de forma que
  \begin{equation*}
  |f(\tt,y_L)-f(\tt,z_L)| >  L  |y_L-z_L|.
 \end{equation*}
 Por ejemplo, dada $L>0$ podemos tomar $y_L=L$ y $z_L=0$, así el
 primer miembro es
 \begin{align*}
   |f(\tt,y_L)-f(\tt,z_L)|&=|L+0|\cdot |L-0|=4L^2,
   \intertext{mientras que el segundo miembro resulta} 
   L|y_L-z_L|&=2L^2<4L^2.
 \end{align*}
\end{example}

A continuación, presentamos los resultados teóricos fundamentales. El
primer Teorema utiliza hipótesis más débiles (\locLipschitz), aunque
sin alcanzar directamente la existencia y unicidad de solución en todo
$[a,b]$.  El Teorema~\ref{thm:existencia-unif-lipschitz} garantiza la
existencia y unicidad de solución de~\eqref{eq:pvi} en $[a,b]$,
aunque a costa de imponer una hipótesis muy fuerte (Lipschitz
uniforme), que reduce considerablemente el rango de problemas
diferenciales abarcados.
\begin{theorem}
  \label{thm:existencia-loc-lipschitz}
  Sea $f\in C^0([\ta,\tb])\times\Rset$ y \locLipschitz. Entonces, para
  cualquier inicialización $\ycero\in\Rset$:
  \begin{enumerate}
  \item Existe una única solución local (definida en
    $[\ta,\ta+\varepsilon]$ para algún $\varepsilon>0$) y existe una
    única solución maximal (es decir, definida en todo $[a,b]$ o bien
    en $[\ta,c)\subset[\ta,\tb]$, para algún $c\in(\ta,\tb)$, y no
    prolongable a $\tt>c$) de~\eqref{eq:pvi}.
  \item Además: o bien la solución maximal $y(\tt)$  está definida en todo
    $[\ta,\tb]$, o bien ésta explota en tiempo finito (es decir existe
    $c\in (\ta,\tb)$ tal que $\lim_{\tt\to c^-} \sol(\tt) = \infty$).
  \end{enumerate}
\end{theorem}

\begin{theorem}
  \label{thm:existencia-unif-lipschitz}
  Sea $f\in C^0([\ta,\tb]\times\Rset$ y \locLipschitz.  Entonces, para
  cualquier inicialización $\ycero\in\Rset$, existe una única solución
  de~\eqref{eq:pvi}, que está definida en todo el intervalo
  $[\ta,\tb]$ (solución maximal).%  Además, para todo $\tt\in[\ta,\tb]$
  % se tiene la siguiente desigualdad:
  % \begin{equation*}
  %   |y(\tt)-y(\ta)| \le (\tb-\ta) \Big( \max_{\tt\in[\ta,\tb]}
  %     f(\tt,y(\ta))\Big) e^{L(\tt-\ta)}.
  % \end{equation*}
\end{theorem}

En lo que sigue, estudiaremos el análisis numérico de problemas
diferenciales en los que, en principio, la función $f(\tt,y)$ es tan
solo \locLipschitz. Por lo tanto el estudio de la existencia de
solución en $[\ta,\tb]$ no será una tarea inmediata. Usando el
Teorema~\ref{thm:existencia-loc-lipschitz}, intentaremos demostrar que
la solución maximal del problema~(\ref{eq:pvi}) está acotada en
$[\ta,\tb]$ y por tanto no explota en tiempo finito en este intervalo,
garantizando así existencia y unicidad de solución en $[\ta,\tb]$ (ver
en el ejemplo~\ref{ex:existencia-unicidad-loc-lipschitz}). Con este
propósito, recordamos ahora algunas propiedades interesantes de las
ecuaciones diferenciales que nos resultarán de gran utilidad.

\begin{proposition}[Algunas propiedades de las ecuaciones diferenciales]
  Bajo las hipótesis del teorema~\ref{thm:existencia-loc-lipschitz}:
  \begin{enumerate}
  \item Sean $y_1(\tt)$ e $y_2(\tt)$ las soluciones de dos problemas del
    tipo~\eqref{eq:pvi} con la misma ecuación diferencial $y'=f(\tt,y)$
    pero con distintos datos iniciales,
    $$y_{a}^{(1)}< y_{a}^{(2)}.$$ 
    Entonces las gráficas de $y_1$ e $y_2$ no se cortan en ningún
    punto. Es decir, si $y_1$ \ee $y_2$ están definidas
    respectivamente en $[a,a+\varepsilon_1]$ y $[a,a+\varepsilon_2]$:
    \begin{equation*}
      y_1(\tt) < y_2(\tt), \quad \forall \tt \in  [a,a+\varepsilon_1]
      \cap [a,a+\varepsilon_2].
    \end{equation*}
    
  \item Sean $y_1(\tt)$ e $y_2(\tt)$ las soluciones de dos problemas del
    tipo~\eqref{eq:pvi} con el mismo dato inicial pero con ecuaciones
    diferenciales diferentes, $y'=f_1(\tt,y)$ $y'=f_2(\tt,y)$. Si
    $$
    f_1(\tt,y) \le f_2(\tt,y) \quad \forall \tt\in[\ta,\tb], \quad
    \forall y\in\Rset,
    $$
    entonces
    $$
    y_1(\tt)\le y_2(\tt) \quad \forall \tt \in  [a,a+\varepsilon_1]
      \cap [a,a+\varepsilon_2].
    $$
  \end{enumerate}
\end{proposition}

\begin{example}
  \label{ex:existencia-unicidad-loc-lipschitz}
  Estudiaremos la existencia y unicidad de solución del siguiente
  problema de valor inicial: 
  \begin{equation*}
    \left\{
      \begin{aligned}
        &y' = -y^2-2y\,\cos \tt, \quad \tt\in [0,2],\\
        &y(0)=1.
      \end{aligned}
    \right.
  \end{equation*}
\end{example}
\section{Métodos numéricos}

Nuestro objetivo será la descripción, análisis e implementación de
distintos métodos numéricos para la aproximación de la solución
de~\eqref{eq:pvi}. Estos métodos partirán con la definición de una
partición del intervalo $[\ta,\tb]$, formada por $N+1$ puntos:
\begin{equation*}
  \ta=\tt_0 < \tt_1 < \cdots < \tt_N=\tb.
\end{equation*}
Por simplicidad, supondremos que la partición es uniforme, es decir,
\begin{equation*}
  \text{ si } h=\frac{b-a}{N}, \quad \text{entonces} \quad
  \tt_n=\ta+nh,\quad \forall n=0\dots,N
\end{equation*}
(en particular, $\tt_0=a$ y $\tt_N=b$). A continuación procedemos como
sigue:
\begin{enumerate}
\item Usamos el dato inicial $y_a$ para arrancar el método numérico,
  definiendo $y_0=y_a$ (más precisamente, $y_0\approx y_a$)
\item Seguidamente definimos una sucesión de forma que $y_{n+1}$ se
  calcula a partir de $y_n$ (y posiblemente de $y_{n-1}$, ...,
  $y_{n-k}$ para algún $k\ge 1$), con el fin de que
  $y_n\approx\sol(\tt_n)$. En concreto, de manera que:
  \begin{enumerate}
  \item El método sea \textit{consistente}, en el sentido de que la
    solución exacta $\{\sol(\tt_n)\}_n$ ``verifique aproximadamente'' el
    esquema numérico
  \item El método sea \textit{convergente}, en el sentido de que la
    solución aproximada $\{y_n\}_n$ ``converja a la solución exacta''
    $\{\sol(\tt_n)\}_n$ cuando $h\to 0$.
  \item El método sea \textit{estable}, en el sentido de que ``responda
    continuamente'' a perturbaciones en los datos iniciales.
  \end{enumerate}
\end{enumerate}
% Más adelante distinguiremos entre métodos de un paso, en los que
% para calcular $y_{n+1}$ utilizamos solamente de $y_n$ y métodos
% multipaso, en los que  $y_{n+1}$ depende de los datos en varias etapas
% anteriores ($y_{n}$, $y_{n-1}$, ..., $y_{n-k}$ para algún $k\ge 1$.)

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../apuntes-MNII.tex"
%%% End: 
